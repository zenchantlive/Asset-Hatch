{
  "reward": {
    "type": "xlm"
  },
  "sourcedFromGithub": false,
  "githubAsSourceMeta": null,
  "isAnonymous": false,
  "coverImage": "",
  "autoGeneratedCover": "",
  "hasPolls": false,
  "totalPollVotes": 0,
  "upvotes": 0,
  "downvotes": 0,
  "untaggedFrom": [],
  "upvotedBy": [],
  "downvotedBy": [],
  "responses": [],
  "followers": [],
  "answeredByTarget": false,
  "inviters": [],
  "duplicatePosts": [],
  "hasReward": false,
  "bookmarkedIn": [],
  "similarPostIds": [],
  "reactionsByCurrentUser": [],
  "toc": [],
  "_id": "695af91a3703962943d999a8",
  "createdAt": "2026-01-04T23:34:50.587Z",
  "updatedAt": "2026-01-05T01:17:10.131Z",
  "views": 2,
  "isActive": true,
  "hasLatex": false,
  "popularity": 7967.9664,
  "discussionScore": 0,
  "enableToc": false,
  "type": "story",
  "partOfPublication": true,
  "responseCount": 0,
  "replyCount": 0,
  "isFeatured": false,
  "isEngaging": false,
  "isDelisted": false,
  "isNotified": false,
  "numCollapsed": 0,
  "reactions": [],
  "totalReactions": 0,
  "totalReactionsByCurrentUser": 0,
  "isPinnedToBlog": false,
  "disableComments": false,
  "commentsPaused": false,
  "syncAlgolia": false,
  "numUniqueUsersWhoReacted": 0,
  "slugOverridden": true,
  "tweetOptions": {
    "enabled": false
  },
  "title": "Part 9: V2.1 - The UI Layer and The Split Brain",
  "cuid": "cmk0dctzu000s02lb3vu07uhz",
  "dateAdded": "2026-01-04T23:34:50.586Z",
  "isCoverAttributionHidden": false,
  "stickCoverToBottom": false,
  "slug": "part-9-v21-the-ui-layer-and-the-split-brain",
  "content": "<p>It was supposed to be a quiet afternoon. \"Just a few tweaks,\" I said. \"Maybe nice up the Generation UI a bit.\"</p>\n<p><img src=\"https://cdn.hashnode.com/res/hashnode/image/upload/v1767569414748/e7590996-8ba4-4d76-b464-e2cf98e2fa36.png\" alt class=\"image--center mx-auto\" /></p>\n<hr />\n<p>Six hours later, I was staring at a completely rewritten frontend architecture, a split-brain condition in my database layer, and a Markdown parser that had decided to go rogue.</p>\n<p>Welcome to Part 9. It’s slightly unhinged.</p>\n<h2 id=\"heading-the-irony-of-v21\">The Irony of \"V2.1\"</h2>\n<p>The goal was simple: Make the Generation UI look \"Premium.\"</p>\n<p>The User (me) wanted:</p>\n<ul>\n<li><p>Responsive grids that actually respond.</p>\n</li>\n<li><p>A \"Mini-Grid\" that tucks away politely.</p>\n</li>\n<li><p>Glassmorphism everywhere.</p>\n</li>\n<li><p><strong>Reduced white space.</strong> (ugh).</p>\n</li>\n</ul>\n<p>The AI (Antigravity &amp; co) delivered. But the cost was a localized war against CSS positioning.</p>\n<h3 id=\"heading-the-layout-war\">The Layout War</h3>\n<p>You know you're in trouble when your git commit message is just <code>fix: remove absolute positioning again</code>.</p>\n<p>We had a <code>DesktopLayout</code> component. It had a <code>PreviewPanel</code>. It had a <code>BottomAssetBar</code>. They were meant to be friends. Instead, they fought for <code>z-index</code> dominance like gladiators.</p>\n<p>The solution? We stopped fighting the browser flow.</p>\n<ul>\n<li><p><strong>Old:</strong> <code>absolute bottom-0 w-full</code> (The chaos engine)</p>\n</li>\n<li><p><strong>New:</strong> <code>flex-1 min-h-0</code> (The peace treaty)</p>\n</li>\n</ul>\n<p>Now, the layout flows like water. The mini-grid expands, the preview shrinks, and nothing explodes. It looks premium. It feels premium. But underneath, the CSS is holding on for dear life.</p>\n<hr />\n<h2 id=\"heading-the-split-brain-dexie-vs-prisma\">The Split Brain: Dexie vs. Prisma</h2>\n<p>Here is a quote from the implementation plan that sums up our entire day:</p>\n<blockquote>\n<p>\"We probably should have moved away from Dexie by now, but we are too busy making the UI pretty.\"</p>\n</blockquote>\n<p>We have created a monster.</p>\n<ol>\n<li><p><strong>Client Side:</strong> Dexie (IndexedDB) holds the \"Draft\" state. It's fast, offline-first, and reactive.</p>\n</li>\n<li><p><strong>Server Side:</strong> Prisma (Postgres) holds the \"Truth.\" It's reliable, structured, and remote.</p>\n</li>\n</ol>\n<p><strong>The Problem:</strong> The user creates a prompt. Dexie says \"Got it!\" The AI generates an asset. Dexie says \"Cool!\" The User approves it. Dexie says \"Approved!\" Then the User clicks \"Export.\" The Server says: <strong>\"I have no idea what you're talking about.\"</strong></p>\n<p>Because we forgot to tell the server.</p>\n<p>We spent two hours building a sync bridge that funnels <code>Approved</code> assets from the browser's brain (Dexie) to the server's brain (Prisma) <em>just</em> so the export endpoint doesn't return an empty ZIP file.</p>\n<p>Did we rewrite the app to use a single database? No. Did we write 400 lines of rigorous sync logic to keep our Frankenstein monster alive? <strong>Absolutely.</strong></p>\n<hr />\n<h2 id=\"heading-markdown-vampires\">Markdown Vampires</h2>\n<p>Then there were the Markdown Vampires.</p>\n<p>You see, our AI is smart. It likes to format things. User: \"Plan an isometric cat.\" AI: \"Here is your plan: \\n\\n### 1. The Cat\"</p>\n<p>The UI? It didn't account for the <code>###</code>. So instead of a nice bold header, the user saw: <code>### 1. The Cat</code></p>\n<p>It was ugly. It was raw. It was un-premium.</p>\n<p>I chased these <code>###</code> strings through three layers of components. <code>PlanPreview</code>. <code>ChatInterface</code>. <code>MarkdownRenderer</code>. Every time I fixed one, another appeared. It was whack-a-mole with syntax highlighting.</p>\n<p>We finally nuked them with a regex that would make a perl golfer cry. But the UI is clean.</p>\n<hr />\n<h2 id=\"heading-smart-extraction-or-stop-helping-me\">Smart Extraction (or, \"Stop Helping Me\")</h2>\n<p>The final boss was the AI's helpfulness. <a target=\"_blank\" href=\"https://github.com/zenchantlive/Asset-Hatch/blob/main/src/memory/adr/014-asset-extraction-strategy.md\">ADR-014</a> stated clearly: \"One Bullet Point = One Asset.\"</p>\n<p>The AI read this as: \"One Bullet Point = A nice scene containing all your assets.\"</p>\n<p><strong>Me:</strong> \"I want a robot and a dog.\" <strong>AI:</strong> \"- A robot playing fetch with a dog.\" <strong>Generation:</strong> A single image of a robot and a dog. <strong>Export:</strong> One sprite. <strong>Me:</strong> \"NO. Isolate them!\"</p>\n<p>We had to implement a \"safety net\" in the prompt builder. It literally grabs the AI by the collar and says, \"Just the first subject. Ignore the rest.\"</p>\n<p><strong>Old AI:</strong> \"A shiny red robot standing next to a blue car.\" <strong>New AI (Safety Net):</strong> \"A shiny red robot.\"</p>\n<p>It's ruthless. It cuts off the AI's creativity at the knees. But now I get individual sprites I can actually use in a game.</p>\n<hr />\n<h2 id=\"heading-conclusion\">Conclusion</h2>\n<p><img src=\"https://cdn.hashnode.com/res/hashnode/image/upload/v1767569500444/04a10a21-0cdc-44b9-ac63-a218953cc976.png\" alt class=\"image--center mx-auto\" /></p>\n<p>We have a beautiful interface. We have a database layer that talks to itself (mostly). We have regexes guarding the gates against markdown. And we have an AI that is terrified to add a second subject to a prompt.</p>\n<p>It's beautiful chaos.</p>\n",
  "contentMarkdown": "It was supposed to be a quiet afternoon. \"Just a few tweaks,\" I said. \"Maybe nice up the Generation UI a bit.\"\n\n![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767569414748/e7590996-8ba4-4d76-b464-e2cf98e2fa36.png align=\"center\")\n\n---\n\nSix hours later, I was staring at a completely rewritten frontend architecture, a split-brain condition in my database layer, and a Markdown parser that had decided to go rogue.\n\nWelcome to Part 9. It’s slightly unhinged.\n\n## The Irony of \"V2.1\"\n\nThe goal was simple: Make the Generation UI look \"Premium.\"\n\nThe User (me) wanted:\n\n* Responsive grids that actually respond.\n    \n* A \"Mini-Grid\" that tucks away politely.\n    \n* Glassmorphism everywhere.\n    \n* **Reduced white space.** (ugh).\n    \n\nThe AI (Antigravity & co) delivered. But the cost was a localized war against CSS positioning.\n\n### The Layout War\n\nYou know you're in trouble when your git commit message is just `fix: remove absolute positioning again`.\n\nWe had a `DesktopLayout` component. It had a `PreviewPanel`. It had a `BottomAssetBar`. They were meant to be friends. Instead, they fought for `z-index` dominance like gladiators.\n\nThe solution? We stopped fighting the browser flow.\n\n* **Old:** `absolute bottom-0 w-full` (The chaos engine)\n    \n* **New:** `flex-1 min-h-0` (The peace treaty)\n    \n\nNow, the layout flows like water. The mini-grid expands, the preview shrinks, and nothing explodes. It looks premium. It feels premium. But underneath, the CSS is holding on for dear life.\n\n---\n\n## The Split Brain: Dexie vs. Prisma\n\nHere is a quote from the implementation plan that sums up our entire day:\n\n> \"We probably should have moved away from Dexie by now, but we are too busy making the UI pretty.\"\n\nWe have created a monster.\n\n1. **Client Side:** Dexie (IndexedDB) holds the \"Draft\" state. It's fast, offline-first, and reactive.\n    \n2. **Server Side:** Prisma (Postgres) holds the \"Truth.\" It's reliable, structured, and remote.\n    \n\n**The Problem:** The user creates a prompt. Dexie says \"Got it!\" The AI generates an asset. Dexie says \"Cool!\" The User approves it. Dexie says \"Approved!\" Then the User clicks \"Export.\" The Server says: **\"I have no idea what you're talking about.\"**\n\nBecause we forgot to tell the server.\n\nWe spent two hours building a sync bridge that funnels `Approved` assets from the browser's brain (Dexie) to the server's brain (Prisma) *just* so the export endpoint doesn't return an empty ZIP file.\n\nDid we rewrite the app to use a single database? No. Did we write 400 lines of rigorous sync logic to keep our Frankenstein monster alive? **Absolutely.**\n\n---\n\n## Markdown Vampires\n\nThen there were the Markdown Vampires.\n\nYou see, our AI is smart. It likes to format things. User: \"Plan an isometric cat.\" AI: \"Here is your plan: \\\\n\\\\n### 1. The Cat\"\n\nThe UI? It didn't account for the `###`. So instead of a nice bold header, the user saw: `### 1. The Cat`\n\nIt was ugly. It was raw. It was un-premium.\n\nI chased these `###` strings through three layers of components. `PlanPreview`. `ChatInterface`. `MarkdownRenderer`. Every time I fixed one, another appeared. It was whack-a-mole with syntax highlighting.\n\nWe finally nuked them with a regex that would make a perl golfer cry. But the UI is clean.\n\n---\n\n## Smart Extraction (or, \"Stop Helping Me\")\n\nThe final boss was the AI's helpfulness. [ADR-014](https://github.com/zenchantlive/Asset-Hatch/blob/main/src/memory/adr/014-asset-extraction-strategy.md) stated clearly: \"One Bullet Point = One Asset.\"\n\nThe AI read this as: \"One Bullet Point = A nice scene containing all your assets.\"\n\n**Me:** \"I want a robot and a dog.\" **AI:** \"- A robot playing fetch with a dog.\" **Generation:** A single image of a robot and a dog. **Export:** One sprite. **Me:** \"NO. Isolate them!\"\n\nWe had to implement a \"safety net\" in the prompt builder. It literally grabs the AI by the collar and says, \"Just the first subject. Ignore the rest.\"\n\n**Old AI:** \"A shiny red robot standing next to a blue car.\" **New AI (Safety Net):** \"A shiny red robot.\"\n\nIt's ruthless. It cuts off the AI's creativity at the knees. But now I get individual sprites I can actually use in a game.\n\n---\n\n## Conclusion\n\n![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767569500444/04a10a21-0cdc-44b9-ac63-a218953cc976.png align=\"center\")\n\nWe have a beautiful interface. We have a database layer that talks to itself (mostly). We have regexes guarding the gates against markdown. And we have an AI that is terrified to add a second subject to a prompt.\n\nIt's beautiful chaos.",
  "brief": "It was supposed to be a quiet afternoon. \"Just a few tweaks,\" I said. \"Maybe nice up the Generation UI a bit.\"\n\n\nSix hours later, I was staring at a completely rewritten frontend architecture, a split-brain condition in my database layer, and a Markd...",
  "author": "695abff5e4c04d1036cd307d",
  "sB": false,
  "isRepublished": false,
  "readTime": 4,
  "draft": "695af70f4253e82f6b969949",
  "tags": [
    "56744723958ef13879b954f5",
    "656653b07175efc56504e003",
    "5a748cf3f7ef75131419eb9e",
    "5f4ebbb150b5c61ec6ef4ad2",
    "56744722958ef13879b950b2"
  ],
  "publication": "695ac03d428b39bd40085e89",
  "metaTitle": "The Split-Brain Problem: Syncing Dexie and Prisma | Part 9",
  "metaDescription": "A \"quick UI tweak\" turned into 6 hours of architecture. Managing state across client and server databases while chasing CSS bugs.",
  "isNewsletterActivated": true,
  "coAuthors": [],
  "dateUpdated": "2026-01-05T01:17:10.131Z",
  "hasCustomDate": false,
  "series": "695ac45c21b769e7641e57a5",
  "pollOptions": [],
  "badges": [],
  "questionReplies": [],
  "contributors": [],
  "uniqueReactions": [],
  "reactionToCountMapUnique": {
    "any": 1
  },
  "id": "695af91a3703962943d999a8"
}