{
  "reward": {
    "type": "xlm"
  },
  "sourcedFromGithub": false,
  "githubAsSourceMeta": null,
  "isAnonymous": false,
  "coverImage": "",
  "autoGeneratedCover": "",
  "hasPolls": false,
  "totalPollVotes": 0,
  "upvotes": 0,
  "downvotes": 0,
  "untaggedFrom": [],
  "upvotedBy": [],
  "downvotedBy": [],
  "responses": [],
  "followers": [],
  "answeredByTarget": false,
  "inviters": [],
  "duplicatePosts": [],
  "hasReward": false,
  "bookmarkedIn": [],
  "similarPostIds": [],
  "reactionsByCurrentUser": [],
  "toc": [],
  "_id": "695afda961a1138687de8e74",
  "createdAt": "2026-01-04T23:54:17.764Z",
  "updatedAt": "2026-01-04T23:54:17.764Z",
  "views": 3,
  "isActive": true,
  "hasLatex": false,
  "popularity": 7967.9924,
  "discussionScore": 0,
  "enableToc": false,
  "type": "story",
  "partOfPublication": true,
  "responseCount": 0,
  "replyCount": 0,
  "isFeatured": false,
  "isEngaging": false,
  "isDelisted": false,
  "isNotified": false,
  "numCollapsed": 0,
  "reactions": [],
  "totalReactions": 0,
  "totalReactionsByCurrentUser": 0,
  "isPinnedToBlog": false,
  "disableComments": false,
  "commentsPaused": false,
  "syncAlgolia": false,
  "numUniqueUsersWhoReacted": 0,
  "slugOverridden": false,
  "tweetOptions": {
    "enabled": false
  },
  "title": "Part 12: The Third Dimension - Directions v3",
  "cuid": "cmk0e1ulf000r02i6biwe9qw4",
  "dateAdded": "2026-01-04T23:54:17.763Z",
  "isCoverAttributionHidden": false,
  "coverImageAttribution": "",
  "coverImagePhotographer": "",
  "stickCoverToBottom": false,
  "slug": "part-12-the-third-dimension-directions-v3",
  "content": "<p>December 31st. The final countdown. While the rest of the world was preparing for parties, we were deep in the guts of the Generation UI, performing open-heart surgery on the Direction Selection system. Likely I will have PTSD from this day. heh.</p>\n<p><img src=\"https://cdn.hashnode.com/res/hashnode/image/upload/v1767570701725/1906edf6-9bca-4256-9837-daa82ea4f412.png\" alt class=\"image--center mx-auto\" /></p>\n<p>Welcome to Part 12. It’s about the overhaul that almost broke us, and the patterns that saved us.</p>\n<h2 id=\"heading-the-icon-based-failure\">The Icon-Based Failure</h2>\n<p>We started the day with \"Direction Selection UX v2.\" It was icon-based, scientific, and... completely boring. You clicked a compass needle, and you <em>hoped</em> the AI generated a \"back view.\" But you couldn't see it until the batch finished.</p>\n<p>The User (me) gave some blunt feedback:</p>\n<blockquote>\n<p>\"The direction variants should be a part of the main image's card... replace the current image at the top with the direction grid.\"</p>\n</blockquote>\n<p>He was right.</p>\n<h2 id=\"heading-image-based-directions-the-3x3-grid\">Image-Based Directions: The 3x3 Grid</h2>\n<p>We scrapped the icons and built an <strong>Image-Based 3x3 Grid</strong> (<a target=\"_blank\" href=\"https://github.com/zenchantlive/Asset-Hatch/blob/main/src/memory/adr/019-direction-grid-image-based-preview.md\">ADR-019</a>).</p>\n<ul>\n<li><p>The <strong>Center Cell</strong> is the \"Reference direction\" (usually Front).</p>\n</li>\n<li><p>The <strong>8 surrounding cells</strong> show actual generated previews of the other directions.</p>\n</li>\n<li><p>Uncaptured directions are greyed out with a ghost-like <code>opacity-40</code> and a hover reveal.</p>\n</li>\n</ul>\n<p>It fits the \"Premium\" aesthetic perfectly. It flows, it’s responsive, and it makes you feel like a game director.</p>\n<h2 id=\"heading-the-asset-not-found-race-condition\">The \"Asset not found\" Race Condition</h2>\n<p>Then we hit the wall.</p>\n<p>When you click \"Generate\" on a new direction in the grid, the UI has to:</p>\n<ol>\n<li><p>Create a \"Child Asset\" in the database.</p>\n</li>\n<li><p>Immediately trigger an API call to generate its image.</p>\n</li>\n</ol>\n<p><strong>The Problem</strong>: React is async. Database writes are async. By the time the API call fired, the database update hadn't \"settled,\" and the API would throw a 404: \"Asset not found.\"</p>\n<p>We chased this ghost for two hours before implementing the <strong>\"Pass Object Directly\" pattern</strong>. Instead of telling the generator: \"Go find asset ID #123,\" we tell it: \"Here is the asset object I just created. Use this while you wait for the state to catch up.\"</p>\n<p>It’s documented in <code>system_patterns.md</code> as our primary defense against React state race conditions.</p>\n<h2 id=\"heading-custom-prompts-stop-the-gaslighting\">Custom Prompts (Stop the Gaslighting)</h2>\n<p>We also fixed a lingering frustration. If you edited a prompt (e.g., \"Give him a blue hat instead of red\") and hit regenerate, the system used to ignore your edits and rebuild the prompt from the original template.</p>\n<p>We updated the <code>GenerateRequest</code> logic to prioritize <code>customPrompt</code>. Now, when you edit, the AI listens. It’s the difference between a tool that \"helps\" and a tool that \"collaborates.\"</p>\n<h2 id=\"heading-the-batch-heart\">The Batch Heart</h2>\n<p>Finally, we rounded out the year with the <strong>Batch Workflow Infrastructure</strong> (f8c80e4).</p>\n<ul>\n<li><p><strong>Version Carousel</strong>: Flip through 5 different attempts at the same sword before deciding which one is \"The One.\"</p>\n</li>\n<li><p><strong>Sequential Animation</strong>: Approved assets now have a 300ms \"spin out\" exit animation. It’s subtle, but it makes bulk approval feel like popping digital bubble wrap.</p>\n</li>\n</ul>\n<h2 id=\"heading-conclusion\">Conclusion</h2>\n<p><img src=\"https://cdn.hashnode.com/res/hashnode/image/upload/v1767570718727/b0257f4a-9430-4bbd-9f5d-19db70e5b7df.png\" alt class=\"image--center mx-auto\" /></p>\n<p>We’ve moved from a basic chat app to a high-speed production pipeline. We have model-swapping, cost-tracking, style-anchoring, and a 3rd-dimension direction grid that actually works.</p>\n<p>One more post to go... Or now. I thought I was done. Turns out, I was wrong. Next up: Migrating to Neon and Prisma.</p>\n",
  "contentMarkdown": "December 31st. The final countdown. While the rest of the world was preparing for parties, we were deep in the guts of the Generation UI, performing open-heart surgery on the Direction Selection system. Likely I will have PTSD from this day. heh.\n\n![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767570701725/1906edf6-9bca-4256-9837-daa82ea4f412.png align=\"center\")\n\nWelcome to Part 12. It’s about the overhaul that almost broke us, and the patterns that saved us.\n\n## The Icon-Based Failure\n\nWe started the day with \"Direction Selection UX v2.\" It was icon-based, scientific, and... completely boring. You clicked a compass needle, and you *hoped* the AI generated a \"back view.\" But you couldn't see it until the batch finished.\n\nThe User (me) gave some blunt feedback:\n\n> \"The direction variants should be a part of the main image's card... replace the current image at the top with the direction grid.\"\n\nHe was right.\n\n## Image-Based Directions: The 3x3 Grid\n\nWe scrapped the icons and built an **Image-Based 3x3 Grid** ([ADR-019](https://github.com/zenchantlive/Asset-Hatch/blob/main/src/memory/adr/019-direction-grid-image-based-preview.md)).\n\n* The **Center Cell** is the \"Reference direction\" (usually Front).\n    \n* The **8 surrounding cells** show actual generated previews of the other directions.\n    \n* Uncaptured directions are greyed out with a ghost-like `opacity-40` and a hover reveal.\n    \n\nIt fits the \"Premium\" aesthetic perfectly. It flows, it’s responsive, and it makes you feel like a game director.\n\n## The \"Asset not found\" Race Condition\n\nThen we hit the wall.\n\nWhen you click \"Generate\" on a new direction in the grid, the UI has to:\n\n1. Create a \"Child Asset\" in the database.\n    \n2. Immediately trigger an API call to generate its image.\n    \n\n**The Problem**: React is async. Database writes are async. By the time the API call fired, the database update hadn't \"settled,\" and the API would throw a 404: \"Asset not found.\"\n\nWe chased this ghost for two hours before implementing the **\"Pass Object Directly\" pattern**. Instead of telling the generator: \"Go find asset ID #123,\" we tell it: \"Here is the asset object I just created. Use this while you wait for the state to catch up.\"\n\nIt’s documented in `system_patterns.md` as our primary defense against React state race conditions.\n\n## Custom Prompts (Stop the Gaslighting)\n\nWe also fixed a lingering frustration. If you edited a prompt (e.g., \"Give him a blue hat instead of red\") and hit regenerate, the system used to ignore your edits and rebuild the prompt from the original template.\n\nWe updated the `GenerateRequest` logic to prioritize `customPrompt`. Now, when you edit, the AI listens. It’s the difference between a tool that \"helps\" and a tool that \"collaborates.\"\n\n## The Batch Heart\n\nFinally, we rounded out the year with the **Batch Workflow Infrastructure** (f8c80e4).\n\n* **Version Carousel**: Flip through 5 different attempts at the same sword before deciding which one is \"The One.\"\n    \n* **Sequential Animation**: Approved assets now have a 300ms \"spin out\" exit animation. It’s subtle, but it makes bulk approval feel like popping digital bubble wrap.\n    \n\n## Conclusion\n\n![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767570718727/b0257f4a-9430-4bbd-9f5d-19db70e5b7df.png align=\"center\")\n\nWe’ve moved from a basic chat app to a high-speed production pipeline. We have model-swapping, cost-tracking, style-anchoring, and a 3rd-dimension direction grid that actually works.\n\nOne more post to go... Or now. I thought I was done. Turns out, I was wrong. Next up: Migrating to Neon and Prisma.",
  "brief": "December 31st. The final countdown. While the rest of the world was preparing for parties, we were deep in the guts of the Generation UI, performing open-heart surgery on the Direction Selection system. Likely I will have PTSD from this day. heh.\n\nWe...",
  "author": "695abff5e4c04d1036cd307d",
  "sB": false,
  "isRepublished": false,
  "readTime": 3,
  "draft": "695afc8ad0f42b38ae98b34f",
  "tags": [
    "695afda82ccfd97102b2ffc1",
    "695afda82ccfd97102b2ffc2",
    "5b5b1cd9d8f5763f693b02b7",
    "63b1ef8cd1e499a9b865b6e6",
    "56744723958ef13879b95434",
    "586df60da55d5976a1f5bdd1"
  ],
  "publication": "695ac03d428b39bd40085e89",
  "metaTitle": "Building a 3x3 Direction Grid for Game Sprite Generation | Part 12",
  "metaDescription": "From icon-based to image-based direction selection. Solving React state race conditions with the \"Pass Object Directly\" pattern.",
  "series": "695ac45c21b769e7641e57a5",
  "isNewsletterActivated": true,
  "coAuthors": [],
  "pollOptions": [],
  "badges": [],
  "questionReplies": [],
  "contributors": [],
  "uniqueReactions": [],
  "reactionToCountMapUnique": {
    "any": 1
  },
  "id": "695afda961a1138687de8e74"
}